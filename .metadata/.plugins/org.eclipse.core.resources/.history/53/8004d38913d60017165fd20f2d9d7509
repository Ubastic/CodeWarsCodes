// Solution for https://www.codewars.com/kata/54c1bf903f0696f04600068b/train/java

public class Machine {

	private final CPU cpu;
	
	public Machine(CPU cpu) {
		this.cpu = cpu;
	}
	
	public void exec(String instr) {
		
		String[] instrParts = instr.split(" ,");
		if(instrParts[0].equals("push")){
			if(instrParts[1].equals("a") || instrParts[1].equals("b") || instrParts[1].equals("c") || instrParts[1].equals("d"))
				cpu.writeStack(cpu.readReg(instrParts[1]));
			else
				cpu.writeStack(Integer.parseInt(instrParts[1]));
		}
		else if(instrParts[0].equals("pop")){
			if(instrParts.length == 1)
				int x = cpu.popStack();
			else
				cpu.writeReg(instrParts[1], cpu.popStack());
		}
		else if(instrParts[0].equals("pushr")){
			cpu.writeStack(cpu.readReg("a"));
			cpu.writeStack(cpu.readReg("b"));
			cpu.writeStack(cpu.readReg("c"));
			cpu.writeStack(cpu.readReg("d"));
		}
		else if(instrParts[0].equals("pushrr")){
			cpu.writeStack(cpu.readReg("d"));
			cpu.writeStack(cpu.readReg("c"));
			cpu.writeStack(cpu.readReg("b"));
			cpu.writeStack(cpu.readReg("a"));
		}
		else if(instrParts[0].equals("popr")){
			cpu.writeReg("d",cpu.popStack());
			cpu.writeReg("c",cpu.popStack()); 
			cpu.writeReg("b",cpu.popStack()); 
			cpu.writeReg("a",cpu.popStack()); 
		}
		else if(instrParts[0].equals("poprr")){
			cpu.writeReg("a",cpu.popStack());
			cpu.writeReg("b",cpu.popStack()); 
			cpu.writeReg("c",cpu.popStack()); 
			cpu.writeReg("d",cpu.popStack()); 
		}
		else if(instrParts[0].equals("mov")){
			if(instrParts[1].equals("a") || instrParts[1].equals("b") || instrParts[1].equals("c") || instrParts[1].equals("d"))
				cpu.writeReg(instrParts[2],cpu.readReg(instrParts[1]));
			else
				cpu.writeReg(instrParts[2],Integer.parseInt(instrParts[1]));
		}
		else if(instrParts[0].equals("add")){
			String reg;
			int numOfArgs;
			if(instrParts[1].equals("a") || instrParts[1].equals("b") || instrParts[1].equals("c") || instrParts[1].equals("d"))
				numOfArgs = cpu.readReg(instrParts[1]);
			else
				numOfArgs = Integer.parseInt(instrParts[1]);
			int sum = 0;
			for(int i = 0; i < numOfArgs; i++)
				sum += cpu.popStack();
			if(instrParts.length != 3)
				String reg = "a";
			else
				reg = instrParts[2];
			cpu.writeReg(reg,sum);
		}
		else if(instrParts[0].equals("sub")){
			
		}	
		else if(instrParts[0].equals("mul")){
			
		}	
		else if(instrParts[0].equals("div")){
			
		}	
		else if(instrParts[0].equals("and")){
			
		}	
		else if(instrParts[0].equals("or")){
			
		}	
		else if(instrParts[0].equals("xor")){
			
		}	
		else if(instrParts[0].equals("adda")){
			
		}	
		else if(instrParts[0].equals("add")){
			
		}	
	}
	
}

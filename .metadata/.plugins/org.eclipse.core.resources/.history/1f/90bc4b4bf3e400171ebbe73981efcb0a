//Solution for https://www.codewars.com/kata/527fde8d24b9309d9b000c4e/train/java

import java.util.ArrayList;

public class BreakPieces {
	
	public static String[] process(String shape){
		
		String[] parts = shape.split("\n");
		int width = 0;
		for(int i = 0; i < parts.length; i++){
			if(parts[i].length() > width)
				width = parts[i].length();
		}
		int height = parts.length;
		int[][] arr = new int[height][width];
		for(int r = 0; r < height; r++){
			int indexA = -1;
			int indexB = -1;
			for(int c = 0; c < parts[r].length(); c++){
				if(parts[r].charAt(c) == '|'){
					indexA = c;
					break;
				}
			}
			for(int c = parts[r].length() - 1; c >= 0; c--){
				if(parts[r].charAt(c) == '|'){
					indexB = c;
					break;
				}
			}
			for(int c = indexA + 1; c < indexB - 1; c++){
				if(parts[r].charAt(c) == ' ')
					arr[r][c] = 1;
			}
		}
		print(arr);
		ArrayList<int[][]> arrList = separate(arr);
		String[] returnArr = convert(arrList, parts); 
		
		return new String[0];
	}
	
	public static ArrayList<int[][]> separate(int[][] arr){
		ArrayList<int[][]>  list = new ArrayList<int[][]>();
		int[][] arrCopy = arr;
		while(true){
			int firstR = -1;
			int firstC = -1;
			boolean flag = false;
			for(int r = 0; r < arr.length; r++){
				for(int c = 0; c < arr[r].length; c++){
					//System.out.println(r + " " + c);
					if(arr[r][c] == 1){
						firstR = r;
						firstC = c;
						flag = true;
						break;
					}
				}
				if(flag)
					break;
			}
			if(firstR == -1 && firstC == -1)
				break;
			//System.out.println(firstR + " " + firstC);
			int[][] tempArr = traverse(arr,firstR,firstC);
			tempArr = fill(tempArr,arrCopy);
			arrCopy = remove(arrCopy,tempArr);
			tempArr = expand(tempArr);
			tempArr = squarify(tempArr);
			list.add(tempArr);
		}
		return list;
	}
	
	public static int[][] traverse(int[][] arr, int r, int c){
		
		//up, right, down, traversal
		int[][] arrA = new int[arr.length][arr[0].length];
		arrA[r][c] = 1;
		while(true){
			if(arr[r - 1][c] == 1 && arrA[r - 1][c] == 0){
				arrA[--r][c] = 1;
			}
			else if(arr[r][c + 1] == 1){
				arrA[r][++c] = 1;
			}
			else if(arr[r + 1][c] == 1){
				arrA[++r][c] = 1;
			}
			else break;
		}
		//down, left, up traversal
		int[][] arrB = new int[arr.length][arr[0].length];
		arrB[r][c] = 1;
		while(true){
			if(arr[r + 1][c] == 1 && arrB[r + 1][c] == 0){
				arrB[++r][c] = 1;
			}
			else if(arr[r][c - 1] == 1){
				arrB[r][--c] = 1;
			}
			else if(arr[r - 1][c] == 1){
				arrB[--r][c] = 1;
			}
			else break;
		}
		
		//print(arrA);
		//print(arrB);
		
		return merge(arrA,arrB);
	}
	
	public static int[][] merge(int[][] a, int[][] b){
		int[][] arr = new int[a.length][a[0].length];
		for(int i = 0; i < arr.length; i++)
			for(int j = 0; j < arr[i].length; j++)
				if(a[i][j] == 1 || b[i][j] == 1)
					arr[i][j] = 1;
		//print(arr);
		return arr;
	}
	
	public static int[][] fill(int [][] arr, int[][] origArr){
		
		//print(arr);
		//top to bottom
		for(int c = 0; c < arr[0].length; c++)
			for(int r = 0; r < arr.length; r++){
				if(arr[r][c] != 1)
					arr[r][c] = 2;
				else
					break;
			}
			
		//bottom to top
		for(int c = 0; c < arr[0].length; c++)
			for(int r = arr.length - 1; r >= 0; r--){
				if(arr[r][c] != 1)
					arr[r][c] = 2;
				else
					break;
			}
		
		//left to right
		for(r = 0; r < arr.length; r++)
			for(int c = 0; c < arr[r].length; c++){
				if(arr[r][c] != 1)
					arr[r][c] = 2;
				else
					break;
			}
				
		//right to left
		for(r = 0; r < arr.length; r++)
			for(int c = arr[r].length - 1; c >= 0; c--){
				if(arr[r][c] != 1)
					arr[r][c] = 2;
				else
					break;
			}
		
		//print(arr);
		
		//flip
		for(int i = 0; i < arr.length; i++)
			for(int j = 0; j < arr[i].length; j++){
				if(arr[i][j] == 0 && origArr[i][j] == 1)
					arr[i][j] = 1;
				else if(arr[i][j] == 2)
					arr[i][j] = 0;
			}
		
		//print(arr);
		
		return arr;
	}
	
	public static int[][] remove(int[][] fromArr, int[][] toRemoveArr){
		for(int i = 0; i < fromArr.length; i++)
			for(int j = 0; j < fromArr[i].length; j++)
				if(toRemoveArr[i][j] == 1)
					fromArr[i][j] = 0;
		//print(fromArr);
		return fromArr;
	}
	
	public static int[][] expand(int[][] arr){
		for(int i = 0; i < arr.length; i++)
			for(int j = 0; j < arr[i].length; j++)
				if(arr[i][j] == 1){
					if(arr[i - 1][j - 1] == 0)
						arr[i - 1][j - 1] = 2;
					if(arr[i][j - 1] == 0)
						arr[i][j - 1] = 2;
					if(arr[i + 1][j] == 0)
						arr[i + 1][j - 1] = 2;
					if(arr[i - 1][j] == 0)
						arr[i - 1][j] = 2;
					if(arr[i + 1][j] == 0)
						arr[i + 1][j] = 2;
					if(arr[i - 1][j + 1] == 0)
						arr[i - 1][j + 1] = 2;
					if(arr[i][j + 1] == 0)
						arr[i][j + 1] = 2;
					if(arr[i + 1][j + 1] == 0)
						arr[i + 1][j + 1] = 2;
				}
		
		for(int i = 0; i < arr.length; i++)
			for(int j = 0; j < arr[i].length; j++)
				if(arr[i][j] == 2)
					arr[i][j] = 1;
		
		print(arr);
		return arr;
	}
	
	public static int[][] squarify(int[][] arr){
		int leftX = arr[0].length, rightX = -1, bottomY = -1, topY = arr.length;
		
		for(int r = 0; r < arr.length; r++)
			for(int c = 0; c < arr[r].length; c++)
				if(arr[r][c] == 1){
					if(c < leftX)
						leftX = c;
					break;
				}
		
		for(int r = 0; r < arr.length; r++)
			for(int c = arr[r].length - 1; c >= 0; c--)
				if(arr[r][c] == 1){
					if(c > rightX)
						rightX = c;
					break;
				}
		
		for(int c = 0; c < arr[0].length; c++){
			for(int r = 0; r < arr.length; r++)
				if(arr[r][c] == 1){
					if(r < topY)
						topY = r;
					break;
				}
		}
		
		for(int c = 0; c < arr[0].length; c++){
			for(int r = arr.length - 1; r >= 0; r--)
				if(arr[r][c] == 1){
					if(r > bottomY)
						bottomY = r;
					break;
				}
		}
	}
	
	public static String[] convert(ArrayList<int[][]> arrList, String[] strArray){
		for(int index = 0; index < arrList.size(); index++)
			for(int i = 0; i < (arrList.get(index)).length; i++)
				for(int j = 0; j < (arrList.get(index))[i].length; j++);
		
	}
	
	public static void print(int[][] arr){
		for(int i = 0; i < arr.length; i++){
			String s = "";
			for(int j = 0; j < arr[i].length; j++)
				s += arr[i][j];
			System.out.println(s);
		}
		System.out.println();
	}
	
}
